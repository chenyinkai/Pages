var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),BeginScene=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=Data.getStageWidth(),e=Data.getStageHeight(),n=new egret.Bitmap;n.texture=RES.getRes("star_jpg"),n.height=e,n.width=t,this.sky=n,this.addChild(n);var r=new egret.Bitmap;r.texture=RES.getRes("title_png"),this.title=r,r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,r.x=t/2,r.y=.3*e,this.addChild(r);var i=new egret.Bitmap;i.texture=RES.getRes("start_png"),this.addChild(i),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.x=t/2,i.y=.58*e,i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startBtnCallback,this),i.addEventListener(egret.TouchEvent.TOUCH_END,this.startBtnCallback,this),i.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.startBtnCallback,this),this.startBtn=i;var a=new egret.Bitmap;a.texture=RES.getRes("help1_png"),this.addChild(a),a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,a.x=t/2,a.y=.7*e,a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.helpBtnCallback,this),a.addEventListener(egret.TouchEvent.TOUCH_END,this.helpBtnCallback,this),a.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.helpBtnCallback,this),this.helpBtn=a},e.prototype.startBtnCallback=function(t){if(t.type==egret.TouchEvent.TOUCH_BEGIN)t.currentTarget.scaleX=1.05,t.currentTarget.scaleY=1.05;else if(t.type==egret.TouchEvent.TOUCH_END){t.currentTarget.scaleX=1,t.currentTarget.scaleY=1;var e=new GameEvent(GameEvent.GAME_GO);this.dispatchEvent(e)}else t.type==egret.TouchEvent.TOUCH_RELEASE_OUTSIDE&&(t.currentTarget.scaleX=1,t.currentTarget.scaleY=1)},e.prototype.helpBtnCallback=function(t){if(t.type==egret.TouchEvent.TOUCH_BEGIN)t.currentTarget.scaleX=1.05,t.currentTarget.scaleY=1.05;else if(t.type==egret.TouchEvent.TOUCH_END){t.currentTarget.scaleX=1,t.currentTarget.scaleY=1,this.touchEnabled=!1,this.startBtn.touchEnabled=!1,this.helpBtn.touchEnabled=!1;var e=new GameEvent(GameEvent.GAME_HELP);this.dispatchEvent(e)}else t.type==egret.TouchEvent.TOUCH_RELEASE_OUTSIDE&&(t.currentTarget.scaleX=1,t.currentTarget.scaleY=1)},e}(egret.Sprite);__reflect(BeginScene.prototype,"BeginScene");var Data=function(){function t(){}return t.getStageWidth=function(){return egret.MainContext.instance.stage.stageWidth},t.getStageHeight=function(){return egret.MainContext.instance.stage.stageHeight},t}();__reflect(Data.prototype,"Data");var EnemyBall=function(t){function e(){var e=t.call(this)||this;return e._cont=60,e.status=0,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2;var t=new egret.Bitmap;t.texture=RES.getRes("fire_png"),this.addChild(t),t.scaleX=.15,t.scaleY=.15,t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.x=0,t.y=0;var e=Math.floor(8*Math.random()+3),n=Math.floor(8*Math.random()+3);Math.random()<.5&&(e*=-1),Math.random()<.5&&(n*=-1),this._speedX=e,this._speedY=n},e.prototype.move=function(t){if(0==this.status){var e=this.x,n=this.y,r=Data.getStageWidth(),i=Data.getStageHeight();e+=this._speedX,n+=this._speedY,0>=e?(this.x=0,this._speedX*=-1):e>=r?(this.x=r,this._speedX*=-1):this.x=e,0>=n?(this.y=0,this._speedY*=-1):n>=i?(this.y=i,this._speedY*=-1):this.y=n}},e}(egret.Sprite);__reflect(EnemyBall.prototype,"EnemyBall");var Game=function(t){function e(){var e=t.call(this)||this;return e.j=0,e.score=0,e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=Data.getStageWidth(),e=Data.getStageHeight(),n=new egret.Bitmap;n.texture=RES.getRes("star_jpg"),this.addChild(n),n.width=t,n.height=e;var r=new MyBall;this.addChild(r),this.myBall=r,r.x=r.width/2,r.y=r.height/2,this.foes=[],this.balls=[],this.timer=new egret.Timer(1e3/30,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerfunc,this),this.timer.start(),this.deaths=[]},e.prototype.timerfunc=function(){if(this.j+=1,this.j%30===0&&this.score++,this.j%60===0){var t=new EnemyBall;Math.random()>=0&&Math.random()<.25?(t.y=Math.floor(Math.random()*Data.getStageHeight()),t.x=-20):Math.random()>=.25&&Math.random()<.5?(t.y=Math.floor(Math.random()*Data.getStageHeight()),t.x=Data.getStageWidth()+20):Math.random()>=.5&&Math.random()<.75?(t.x=Math.floor(Math.random()*Data.getStageWidth()),t.y=-20):(t.x=Math.floor(Math.random()*Data.getStageWidth()),t.y=Data.getStageHeight()+20),this.foes.push(t),this.addChild(t),this.balls.push(t)}for(var e=0,n=0,r=0;r<this.balls.length;r++)e=Math.floor(Math.sqrt((this.balls[r].x-this.myBall.x)*(this.balls[r].x-this.myBall.x)+(this.balls[r].y-this.myBall.y)*(this.balls[r].y-this.myBall.y))),n=80,n>e&&this.drawInit();for(var i=0;i<this.foes.length;i++)this.foes[i].move(this.deaths)},e.prototype.drawInit=function(){var t=0,e=Data.getStageWidth(),n=Data.getStageHeight();t=this.score,this.nowscore=t;var r=new egret.Shape;r.graphics.beginFill(16777215),r.graphics.drawRect(0,0,400,400),r.graphics.endFill(),r.anchorOffsetX=r.width/2,r.x=e/2,r.y=.1*n,this.addChild(r);var i=new egret.TextField;this.addChild(i),i.x=150,i.y=.13*n,i.size=50,i.textColor=16711680,console.log(this.score),this.nowscore>0&&this.nowscore<=5?i.text="  你坚持了"+this.nowscore+'秒\n\n    获得称号\n\n   "重度脑瘫"':this.nowscore>5&&this.nowscore<=10?i.text="  你坚持了"+this.nowscore+'秒\n\n    获得称号\n\n   "不堪一击"':this.nowscore>10&&this.nowscore<=15?i.text="  你坚持了"+this.nowscore+'秒\n\n    获得称号\n\n   "勉勉强强"':this.nowscore>15&&this.nowscore<=20?i.text="  你坚持了"+this.nowscore+'秒\n\n    获得称号\n\n   "炉火纯青"':this.nowscore>20&&this.nowscore<=25?i.text="  你坚持了"+this.nowscore+'秒\n\n    获得称号\n\n   "傲世群众"':this.nowscore>25&&this.nowscore<=30?i.text="  你坚持了"+this.nowscore+'秒\n\n    获得称号\n\n   "大神在此"':this.nowscore>30&&this.nowscore<=35?i.text="  你坚持了"+this.nowscore+'秒\n\n    获得称号\n\n   "超越了神"':this.nowscore>35&&this.nowscore<=40?i.text="  你坚持了"+this.nowscore+'秒\n\n    获得称号\n\n   "前无古人"':this.nowscore>40&&(i.text="  你坚持了"+this.nowscore+'秒\n\n    获得称号\n\n"地球的守护者"'),this.removeChild(this.myBall),this.timer.stop();var a=new GameEvent(GameEvent.GAME_OVER);this.dispatchEvent(a)},e}(egret.Sprite);__reflect(Game.prototype,"Game");var GameEvent=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.GAME_OVER="game_over_event",e.GAME_HIT="game_hit_event",e.GAME_START="game_start_event",e.GAME_GO="game_go_event",e.GAME_CONTINUE="game_continue_event",e.GAME_BLEED="game_bleed_event",e.GAME_HELP="game_help_event",e.GAME_HINT="game_hint_event",e}(egret.Event);__reflect(GameEvent.prototype,"GameEvent");var HelpLayer=function(t){function e(){var e=t.call(this)||this;return e.stageW=0,e.stageH=0,e.setUI(),e}return __extends(e,t),e.prototype.setUI=function(){this.stageW=Data.getStageWidth(),this.stageH=Data.getStageHeight();var t=this.stageW,e=this.stageH,n=new egret.Bitmap;n.texture=RES.getRes("star_jpg"),n.height=e,n.width=t,this.sky=n,this.addChild(n);var r=new egret.Bitmap;r.texture=RES.getRes("rules_png"),this.addChild(r),r.anchorOffsetX=r.width/2,r.anchorOffsetY=0,r.x=t/2,r.y=200,this.bg=r;var i=new egret.Bitmap;i.texture=RES.getRes("return_png"),this.addChild(i),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.x=t/2,i.y=.8*e,i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.homeBtnCallback,this),i.addEventListener(egret.TouchEvent.TOUCH_END,this.homeBtnCallback,this),i.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.homeBtnCallback,this)},e.prototype.homeBtnCallback=function(t){if(t.type==egret.TouchEvent.TOUCH_BEGIN)t.currentTarget.scaleX=1.05,t.currentTarget.scaleY=1.05;else if(t.type==egret.TouchEvent.TOUCH_END){t.currentTarget.scaleX=1,t.currentTarget.scaleY=1;var e=new GameEvent(GameEvent.GAME_START);this.dispatchEvent(e)}else t.type==egret.TouchEvent.TOUCH_RELEASE_OUTSIDE&&(t.currentTarget.scaleX=1,t.currentTarget.scaleY=1)},e}(egret.Sprite);__reflect(HelpLayer.prototype,"HelpLayer");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},e.prototype.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.createGameScene=function(){var t=new BeginScene;this.addChild(t),t.addEventListener(GameEvent.GAME_GO,this.go,this),t.addEventListener(GameEvent.GAME_HELP,this.help,this)},e.prototype.startgame=function(){this.removeChildren();var t=new BeginScene;this.addChild(t),t.addEventListener(GameEvent.GAME_GO,this.go,this),t.addEventListener(GameEvent.GAME_HELP,this.help,this)},e.prototype.go=function(){this.removeChildren();var t=new Game;this.addChild(t),t.addEventListener(GameEvent.GAME_OVER,this.gameover,this)},e.prototype.gameover=function(){var t=new OverScene;this.addChild(t),t.addEventListener(GameEvent.GAME_CONTINUE,this.begingame,this),t.addEventListener(GameEvent.GAME_BLEED,this.startgame,this)},e.prototype.begingame=function(){this.go()},e.prototype.help=function(){this.removeChildren();var t=new HelpLayer;this.addChild(t),t.addEventListener(GameEvent.GAME_START,this.startgame,this)},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var MyBall=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=new egret.Bitmap;t.texture=RES.getRes("earth_png"),this.addChild(t),t.x=0,t.y=0,t.scaleX=.5,t.scaleY=.5,this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,t.touchEnabled=!0,this.myBall=t,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.mouseDown,this),t.addEventListener(egret.TouchEvent.TOUCH_END,this.mouseUp,this),t.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this)},e.prototype.mouseDown=function(t){var e=new egret.Point(t.stageX,t.stageY);this.x=e.x,this.y=e.y},e.prototype.mouseMove=function(t){var e=Data.getStageWidth(),n=Data.getStageHeight(),r=new egret.Point(t.stageX,t.stageY);this.x=r.x,this.y=r.y,this.x<50?this.x=50:this.x>e-50&&(this.x=e-50),this.y<=50?this.y=50:this.y>=n-50&&(this.y=n-50)},e.prototype.mouseUp=function(t){},e}(egret.Sprite);__reflect(MyBall.prototype,"MyBall");var OverScene=function(t){function e(){var e=t.call(this)||this;return e.stageW=0,e.stageH=0,e.setUI(),e}return __extends(e,t),e.prototype.setUI=function(){this.stageW=Data.getStageWidth(),this.stageH=Data.getStageHeight();var t=this.stageW,e=this.stageH,n=new egret.Bitmap;n.texture=RES.getRes("return_png"),this.addChild(n),n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.x=t/2,n.y=.72*e,n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.againBtnCallback,this),n.addEventListener(egret.TouchEvent.TOUCH_END,this.againBtnCallback,this),n.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.againBtnCallback,this);var r=new egret.Bitmap;r.texture=RES.getRes("again_png"),this.addChild(r),r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,r.x=t/2,r.y=.6*e,r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.homeBtnCallback,this),r.addEventListener(egret.TouchEvent.TOUCH_END,this.homeBtnCallback,this),r.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.homeBtnCallback,this)},e.prototype.homeBtnCallback=function(t){if(t.type==egret.TouchEvent.TOUCH_BEGIN)t.currentTarget.scaleX=1.05,t.currentTarget.scaleY=1.05;else if(t.type==egret.TouchEvent.TOUCH_END){t.currentTarget.scaleX=1,t.currentTarget.scaleY=1;var e=new GameEvent(GameEvent.GAME_CONTINUE);this.dispatchEvent(e)}else t.type==egret.TouchEvent.TOUCH_RELEASE_OUTSIDE&&(t.currentTarget.scaleX=1,t.currentTarget.scaleY=1)},e.prototype.againBtnCallback=function(t){if(t.type==egret.TouchEvent.TOUCH_BEGIN)t.currentTarget.scaleX=1.05,t.currentTarget.scaleY=1.05;else if(t.type==egret.TouchEvent.TOUCH_END){t.currentTarget.scaleX=1,t.currentTarget.scaleY=1;var e=new GameEvent(GameEvent.GAME_BLEED);this.dispatchEvent(e)}else t.type==egret.TouchEvent.TOUCH_RELEASE_OUTSIDE&&(t.currentTarget.scaleX=1,t.currentTarget.scaleY=1)},e}(egret.Sprite);__reflect(OverScene.prototype,"OverScene");